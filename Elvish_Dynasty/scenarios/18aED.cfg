#textdomain wesnoth-eldy
[scenario]

id=18aED
next_scenario=EDTier2
name = _"Jungle Lairs"

map_data="{~add-ons/Elvish_Dynasty/maps/18aEDJungle_Lairs}"
victory_when_enemies_defeated=no
	
#Difficulty level affects turns only
#ifdef TOURIST
turns=48
#endif
	
#ifdef EASY
turns=45	
#endif
	
#ifdef NORMAL
turns=42
#endif
	
#ifdef HARD
turns=40
#endif

	{SCENARIO_MUSIC "northern_mountains.ogg"}
    {EXTRA_SCENARIO_MUSIC "the_city_falls.ogg"}

	
	{DEFAULT_SCHEDULE}
    

[side]
	side=1
	controller=human
	team_name=protagonist
	user_team_name= _"Florians"
	id=Aurelia
        name= _ "Aurelia"
        type=Aurelia Elvish Shaman
        fog=no
        canrecruit=yes
        unrenamable=yes
        recruit=
        gold=0
        village_gold=30
        colour=teal

		#One village provides 30 gold per turn, as noted in the start briefing
		[village]
			x=30
			y=33
		[/village]
		
[/side] 

[side]
	side=2
	controller=ai
	team_name=monsters1
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=3
	controller=ai
	team_name=monsters2
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=4
	controller=ai
	team_name=monsters3
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=5
	controller=ai
	team_name=monsters4
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=6
	controller=ai
	team_name=monsters5
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=7
	controller=ai
	team_name=monsters6
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=8
	controller=ai
	team_name=monsters7
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[side]
	side=9
	controller=ai
	team_name=monsters8
	user_team_name= _"Monsters"
	no_leader=yes
	canrecruit=no
	recruit=
	gold=0
	colour=red
	
	[ai]
		aggression=1.0	
	[/ai]
	
[/side]

[event]
	name=prestart
	[objectives]
		side=1
		[objective]
			description= _ "Eliminate all monsters and monster lairs on the island"
			condition=win
		[/objective]
		[objective]
        description= _ "Death of Aurelia"
        condition=lose
    	[/objective]
    	[objective]
        description= _ "Death of Bryony"
        condition=lose
    	[/objective]
    	[objective]
        description= _ "Turns run out"
        condition=lose
        [/objective]
    [/objectives]
   
    
    [set_variable]
			name=lairs_cleared
			value=0
	[/set_variable]
	[set_variable]
			name=monster_infighting
			value=0
	[/set_variable]
	
	#There are 16 possible lairs but the player will only encounter 8
	#Each of 8 possible locations has two possible lairs, A and B
	#Lair variable value key:
	#1 means lair A is active
	#2 means lair B is active
	#3 means lair A is destroyed
	#4 means lair B is destroyed
	
	[set_variable]
	name=lair1
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair2
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair3
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair4
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair5
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair6
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair7
	random=1,2
	[/set_variable]
	[set_variable]
	name=lair8
	random=1,2
	[/set_variable]
	
	[if]
		[variable]
			name=lair1
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/wreck.png 28 43}
		[label]
			x,y=28,43
			text= _ "Derelict Ship"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/whirlpool.png 28 43}
		[label]
			x,y=28,43
			text= _ "Strange Vortex"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair2
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/lighthouse.png 7 44}
		[label]
			x,y=7,44
			text= _ "Cobwebbed Lighthouse"
		[/label]
		
		[/then]
		
		[else]
		
		{MODIFY_TERRAIN Ko 7 44}
		[label]
			x,y=7,44
			text= _ "Goblin Fort"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair3
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/temple1.png 7 25}
		[label]
			x,y=7,25
			text= _ "Evil Temple"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/village-human-burned2.png 7 25}
		[label]
			x,y=7,25
			text= _ "Haunted House"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair4
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/mine-abandoned.png 14 5}
		[label]
			x,y=14,5
			text= _ "Old Mine Shaft"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/dwarven-doors-closed.png 14 5}
		[label]
			x,y=14,5
			text= _ "Abandoned Outpost"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair5
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/rune1.png 28 4}
    	{PLACE_IMAGE scenery/rune2.png 30 3}
    	{PLACE_IMAGE scenery/rune3.png 32 4}
    	{PLACE_IMAGE scenery/rune4.png 28 6}
    	{PLACE_IMAGE scenery/rune5.png 30 7}
    	{PLACE_IMAGE scenery/rune6.png 32 6}
    	{PLACE_IMAGE items/book5.png 30 5}
		[label]
			x,y=30,5
			text= _ "Ritual Site (Passive)"
		[/label]
		
		[/then]
		
		[else]
		
		#define PETRIFIED
    	[status]
        	petrified=on
	    [/status]
		#enddef
		
		#define PETRIFIED_UNIT TYPE X Y
    	[unit]
        	side=5
        	type={TYPE}
        	x={X}
        	y={Y}
        	{PETRIFIED}
    	[/unit]
		#enddef

        {PETRIFIED_UNIT "Troll Whelp" 28 4}
        {PETRIFIED_UNIT "Troll Whelp" 28 6}
        {PETRIFIED_UNIT "Troll Rocklobber" 30 3}
        {PETRIFIED_UNIT "Troll Rocklobber" 30 7}
        {PETRIFIED_UNIT "Troll" 32 4}
        {PETRIFIED_UNIT "Troll" 32 6}
        
        {MODIFY_UNIT x,y=32,4 facing sw}
        {MODIFY_UNIT x,y=32,6 facing sw}
		
		{PLACE_IMAGE items/chest-plain-closed.png 30 5}
		[label]
			x,y=30,5
			text= _ "Petrified Trolls (Passive)"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair6
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE scenery/nest-full.png 52 4}
		[label]
			x,y=52,4
			text= _ "Gryphon Nest"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/well.png 52 4}
		[label]
			x,y=52,4
			text= _ "Slimy Well"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair7
			numerical_equals=1
		[/variable]
		[then]
		
		{PLACE_IMAGE items/bonestack.png 52 19}
		{PLACE_IMAGE items/burial.png 52 23}
		{PLACE_IMAGE items/bones.png 50 21}
		{PLACE_IMAGE items/bones.png 48 24}
		{PLACE_IMAGE items/orcish-flag.png 54 16}
		[label]
			x,y=52,19
			text= _ "Orc Burial Ground"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/trapdoor-open.png 52 19}
		[label]
			x,y=52,19
			text= _ "Crypt"
		[/label]
		
		[/else]
	[/if]
	
	[if]
		[variable]
			name=lair8
			numerical_equals=1
		[/variable]
		[then]
		
		{MODIFY_TERRAIN Dd^Dc 52 31}
		[label]
			x,y=52,31
			text= _ "Scorpion Nest"
		[/label]
		
		[/then]
		
		[else]
		
		{PLACE_IMAGE scenery/tent-ruin-1.png 52 31}
		{PLACE_IMAGE items/cage.png 50 32}
		[label]
			x,y=52,31
			text= _ "Slaver Camp"
		[/label]
		
		[/else]
	[/if]
		
	[label]
		x,y=30,33
		text= _ "Supply Station"
	[/label]

	
		[recall]
            id=Bryony
            x=30
            y=30
        [/recall]
       
    [store_unit]
			variable=Kirielle_store
			kill=yes
			[filter]
				id=Kirielle
			[/filter]
	[/store_unit]
	
	{MODIFY_TERRAIN Ww 19 41}
	{MODIFY_TERRAIN Ww 21 42}
	{MODIFY_TERRAIN Ww 23 43}
	{MODIFY_TERRAIN Ww 25 44}
	{MODIFY_TERRAIN Ww 18 42}
	{MODIFY_TERRAIN Ww 20 43}
	{MODIFY_TERRAIN Ww 22 44}
	{MODIFY_TERRAIN Ww 24 45}
    
    #Guarantee the monsters get an initial spawn


[/event]

[event]
	name=start
	
	[message]
    	speaker=Bryony
        message= _ "This humid jungle isn't too different from our forests in Floria. I think our people will be able to fight quite well in this terrain."
    [/message]
    
    [scroll_to]
    	x,y=30,33
    [/scroll_to]

    [delay]
    	time=500
    [/delay]
    
    [message]
    	speaker=Bryony
        message= _ "There's no villages or roads or infrastructure of any kind, so Kirielle is going to supply us by sea. Our supply station will provide 30 gold per turn. We should guard it well!"
    [/message]
    [message]
    	speaker=Bryony
        message= _ "Without villages for healing we'll have to rely on the priestesses of the Viridian Order. Make sure to recruit a lot of them!"
    [/message]
    [message]
    	speaker=Bryony
        message= _ "It looks like there are eight locations that'll need to be secured. I've labeled them on your map. Be wary! Monsters will defend their lairs with great tenacity!"
    [/message]
    [message]
    	speaker=Bryony
        message= _ "Once all the monsters and monster lairs and have been eliminated we'll be able to send in our research teams. I know you'll lead us to victory, Aurelia!"
    [/message]
	
	
[/event]


#################################
#####LAIR DESTRUCTION EVENTS#####
#################################

#Side 2 southern water lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=28
		y=43
		[/filter]
		
		[if]
		[variable]
			name=lair1
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to smash this derelict ship yet?)"
					[option]
						message= _ "Yes, smash it!"
					[command]
					[unit]
					type=Cuttle Fish
					side=2
					x=28
					y=43
					[/unit]
					[unit]
					type=Cuttle Fish
					side=2
					x=27
					y=43
					[/unit]
					[unit]
					type=Cuttle Fish
					side=2
					x=29
					y=44
					[/unit]
					[removeitem]
					x,y=28,43
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 28 43}
					[label]
					x,y=28,43
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair1
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair1
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to disturb this strange vortex yet?)"
					[option]
						message= _ "Yes, attack!"
					[command]
					[unit]
					type=Sea Serpent
					side=2
					x=28
					y=43
					[/unit]
					[unit]
					type=Sea Serpent
					side=2
					x=27
					y=43
					[/unit]
					[removeitem]
					x,y=28,43
					[/removeitem]
					[label]
					x,y=28,43
					text= _ ""
					[/label]
					
					[sound]
					name=water-blast.wav
					[/sound]
					
					[set_variable]
					name=lair1
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 3 southwest peninsula lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=7
		y=44
		[/filter]
		
		[if]
		[variable]
			name=lair2
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to topple this cobwebbed lighthouse yet?)"
					[option]
						message= _ "Yes, topple it!"
					[command]
					[unit]
					type=Giant Spider
					side=3
					x=7
					y=43
					[/unit]
					[unit]
					type=Giant Spider
					side=3
					x=7
					y=45
					[/unit]
					[removeitem]
					x,y=7,44
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 7 44}
					[label]
					x,y=7,44
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair2
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair2
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to storm this goblin fort yet?)"
					[option]
						message= _ "Yes, storm it!"
					[command]
					[unit]
					type=Goblin Rouser
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Rouser
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Impaler
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Spearman
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Spearman
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Spearman
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Spearman
					side=3
					x=7
					y=44
					[/unit]
					[unit]
					type=Goblin Spearman
					side=3
					x=7
					y=44
					[/unit]
					
					
					{MODIFY_TERRAIN Co 7 44}
					[label]
					x,y=7,44
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair2
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 4 western jungle lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=7
		y=25
		[/filter]
		
		[if]
		[variable]
			name=lair3
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to lay siege to this evil temple yet?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Dark Sorcerer
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Dark Sorcerer
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Dark Adept
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Dark Adept
					side=4
					x=7
					y=25
					[/unit]
					[removeitem]
					x,y=7,25
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 7 25}
					[label]
					x,y=7,25
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair3
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair3
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to tear down this haunted house yet?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Wraith
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Shadow
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Ghost
					side=4
					x=7
					y=25
					[/unit]
					[unit]
					type=Ghost
					side=4
					x=7
					y=25
					[/unit]
					
					
					[removeitem]
					x,y=7,25
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 7 25}
					[label]
					x,y=7,25
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair3
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 5 northwestern mountain lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=14
		y=5
		[/filter]
		
		[if]
		[variable]
			name=lair4
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to cave in this old mine shaft yet?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Dread Bat
					side=5
					x=14
					y=5
					[/unit]
					[unit]
					type=Dread Bat
					side=5
					x=14
					y=5
					[/unit]
					[unit]
					type=Blood Bat
					side=5
					x=14
					y=5
					[/unit]
					[unit]
					type=Vampire Bat
					side=5
					x=14
					y=5
					[/unit]
					[unit]
					type=Vampire Bat
					side=5
					x=14
					y=5
					[/unit]
					
					[removeitem]
					x,y=14,5
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 14 5}
					[label]
					x,y=14,5
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair4
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair4
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to assault this abandoned outpost yet?)"
					[option]
						message= _ "Yes, assault it!"
					[command]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					[unit]
					type=Wolf
					side=4
					x=14
					y=5
					[/unit]
					
					
					
					[removeitem]
					x,y=14,5
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 14 5}
					[label]
					x,y=14,5
					text= _ ""
					[/label]
					
					[sound]
					name=wose-die.ogg
					[/sound]
					
					[set_variable]
					name=lair4
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 6 north passive lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=30
		y=5
		[not]
		type=Wolf,Gryphon
		[/not]
		[/filter]
		
		[if]
		[variable]
			name=lair5
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(A feeling of strong foreboding surrounds this ritual site. Should someone in your army read from the ritual book?)"
					[option]
						message= _ "Yes!"
					[command]
					
					[sound]
						name=lightning.ogg
					[/sound]
					{QUAKE "rumble.ogg"}
					
					[removeitem]
					x,y=30,5
					[/removeitem]
					[removeitem]
					x,y=28,4
					[/removeitem]
					[removeitem]
					x,y=30,3
					[/removeitem]
					[removeitem]
					x,y=32,4
					[/removeitem]
					[removeitem]
					x,y=28,6
					[/removeitem]
					[removeitem]
					x,y=30,7
					[/removeitem]
					[removeitem]
					x,y=32,6
					[/removeitem]
					
					{PLACE_IMAGE scenery/rune1-glow.png 28 4}
    				{PLACE_IMAGE scenery/rune2-glow.png 30 3}
    				{PLACE_IMAGE scenery/rune3-glow.png 32 4}
    				{PLACE_IMAGE scenery/rune4-glow.png 28 6}
    				{PLACE_IMAGE scenery/rune5-glow.png 30 7}
    				{PLACE_IMAGE scenery/rune6-glow.png 32 6}
					
					[unit]
					type=Skeletal Dragon
					side=6
					x=30
					y=3
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=29
					y=5
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=29
					y=6
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=30
					y=4
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=30
					y=6
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=31
					y=5
					animate=yes
					[/unit]
					[unit]
					type=Tentacle of the Deep
					side=6
					x=31
					y=6
					animate=yes
					[/unit]
					
					
					[label]
					x,y=30,5
					text= _ ""
					[/label]
					
					[redraw]
					[/redraw]
					
					[message]
        				speaker=unit
        				message= _ "This is going to be a tough fight!"
        			[/message]
        
					[set_variable]
					name=lair5
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair5
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Those troll guardian statues look very lifelike...Should we open the treasure chest?)"
					[option]
						message= _ "Yes, open the chest!"
					[command]
					
					#Don't need to specify a filter here since these are the only petrified units possible
					[unpetrify]
					[/unpetrify]
					
					{PLACE_IMAGE items/chest-plain-open.png 30 5}
					[label]
					x,y=30,5
					text= _ ""
					[/label]
					
					[sound]
						name=lightning.ogg
					[/sound]
					{QUAKE "rumble.ogg"}
					
					[redraw]
					[/redraw]
					
					[message]
        				speaker=unit
        				message= _ "If we were looking for treasure in that chest we're out of luck! But if we were looking to fight the trolls then we're in luck..."
        			[/message]
        			
					[set_variable]
					name=lair5
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#If the player has gryphon or wolf pets...
[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=30
		y=5
		type=Wolf,Gryphon
		[/filter]
		
		[if]
		[variable]
			name=lair5
			numerical_equals=1
		[/variable]
		[then]
		[message]
				speaker=unit
				message= _ "(A feeling of strong foreboding surrounds this ritual site. But an illiterate beast won't be able to read from that ritual book! Maybe you should move another unit here...)"
		[/message]
		[/then]
		[/if]
		[if]
		[variable]
			name=lair5
			numerical_equals=2
		[/variable]
		[then]
		[message]
				speaker=unit
				message= _ "(Those troll guardian statues look very lifelike...But a mere beast won't be able to open the lock on this treasure chest, and simply destroying the chest might damage whatever's inside. Maybe you should move another unit here...)"
		[/message]
		[/then]
		[/if]
		
[/event]

#Side 7 northeastern mountain lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=52
		y=4
		[/filter]
		
		[if]
		[variable]
			name=lair6
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(There are some eggs in the nest. Smash them?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Gryphon
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Gryphon
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Gryphon
					side=7
					x=52
					y=4
					[/unit]
					
					
					[removeitem]
					x,y=52,4
					[/removeitem]
					{PLACE_IMAGE scenery/nest-empty.png 52 4}
					[label]
					x,y=52,4
					text= _ ""
					[/label]
					
					[sound]
					name=gryphon-shriek-1.ogg
					[/sound]
					
					[set_variable]
					name=lair6
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair6
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to collapse this slimy well yet?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Giant Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Ooze
					side=7
					x=52
					y=4
					[/unit]
					[unit]
					type=Ooze
					side=7
					x=52
					y=4
					[/unit]
					
					[removeitem]
					x,y=52,4
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 52 4}
					[label]
					x,y=52,4
					text= _ ""
					[/label]
					
					[sound]
					name=water-blast.wav
					[/sound]
					
					[set_variable]
					name=lair6
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 8 eastern clearing lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=52
		y=19
		[/filter]
		
		[if]
		[variable]
			name=lair7
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(This pillar of bones seems to be the source of the evil here. Crush it?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Chocobone
					side=8
					x=52
					y=19
					[/unit]
					[unit]
					type=Bone Shooter
					side=8
					x=52
					y=19
					[/unit]
					[unit]
					type=Deathblade
					side=8
					x=52
					y=19
					[/unit]
					
					
					[removeitem]
					x,y=52,19
					[/removeitem]
					{PLACE_IMAGE items/bones.png 52 19}
					[label]
					x,y=52,19
					text= _ ""
					[/label]
					
					[sound]
					name=skeleton-big-die.ogg
					[/sound]
					
					[set_variable]
					name=lair7
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair7
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to seal up this crypt yet?)"
					[option]
						message= _ "Yes, seal it up!"
					[command]
					[unit]
					type=Necrophage
					side=8
					x=52
					y=19
					[/unit]
					[unit]
					type=Necrophage
					side=8
					x=52
					y=19
					[/unit]
					[unit]
					type=Ghoul
					side=8
					x=52
					y=19
					[/unit]
					[unit]
					type=Ghoul
					side=8
					x=52
					y=19
					[/unit]
					
					
					[removeitem]
					x,y=52,19
					[/removeitem]
					{PLACE_IMAGE scenery/trapdoor-closed.png 52 19}
					[label]
					x,y=52,19
					text= _ ""
					[/label]
					
					[sound]
					name=open-chest.wav
					[/sound]
					
					[set_variable]
					name=lair7
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

#Side 9 southeastern jungle lair

[event]
	name=moveto
	first_time_only=no
		[filter]
		side=1
		x=52
		y=31
		[/filter]
		
		[if]
		[variable]
			name=lair8
			numerical_equals=1
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(There are strange distortions in the sand here. Disturb them?)"
					[option]
						message= _ "Yes!"
					[command]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Giant Scorpion
					side=9
					x=52
					y=31
					[/unit]
					
					{MODIFY_TERRAIN Ds 52 31}
					
					
					[label]
					x,y=52,31
					text= _ ""
					[/label]
					
					[sound]
					name=hiss-big.wav
					[/sound]
					
					[set_variable]
					name=lair8
					value=3
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
       
        [if]
		[variable]
			name=lair8
			numerical_equals=2
		[/variable]
		[then]
				
        [message]
				speaker=unit
				message= _ "(Are we ready to attack this slaver camp yet?)"
					[option]
						message= _ "Yes, attack!"
					[command]
					[unit]
					type=Ogre
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Ogre
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Young Ogre
					side=9
					x=52
					y=31
					[/unit]
					[unit]
					type=Young Ogre
					side=9
					x=52
					y=31
					[/unit]
				
					
					
					[removeitem]
					x,y=52,31
					[/removeitem]
					{PLACE_IMAGE scenery/rubble.png 52 31}
					[label]
					x,y=52,31
					text= _ ""
					[/label]
					
					[sound]
					name=ogre-die-3.ogg
					[/sound]
					
					[set_variable]
					name=lair8
					value=4
					[/set_variable]
					[set_variable]
						name=lairs_cleared
						add=1
					[/set_variable]
					
					[/command]
					[/option]
					[option]
					message= _ "No, leave it alone for now."
					[command]
					
					[/command]
					[/option]
				[/message]
       [/then]
       [/if]
			
[/event]

################################
#####MONSTER COMMENT EVENTS#####
################################

[event]
        name=attack
        first_time_only=no
        [filter]
            [not]
            	side=1
            [/not]
        [/filter]
        [filter_second]
            [not]
            	side=1
            [/not]
        [/filter_second]
        
        [if]
		[variable]
			name=monster_infighting
			numerical_equals=0
		[/variable]
		[then]
		
		[set_variable]
			name=monster_infighting
			value=1
		[/set_variable]
		[message]
            id=Bryony
            message= _ "This should be easy! Our enemies are fighting each other!"
        [/message]
        
		[/then]
		[/if]
        
[/event]

[event]
        name=die
        first_time_only=yes
        [filter]
            type=Ooze
            [or]
            type=Giant Ooze
            [/or]
        [/filter]
        [filter_second]
            	side=1
        [/filter_second]
        
		[message]
            id=Aurelia
            message= _ "(You feel a twinge of regret as the ooze creature is destroyed. How odd!)"
        [/message]
        
        
[/event]


###########################
#####LAIR SPAWN EVENTS#####
###########################

#Checks to see what lair is active and if a monster should be generated
#There's a 20% chance per turn of a monster spawn being generated at a lair

[event]
	name=side 1 turn
	first_time_only=no
	
		#Lair 1 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		#[set_variable]
		#name=monster_variety
		#random=1,2
		#[/set_variable]
		
		[if]
		[variable]
			name=lair1
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			
			[unit]
				type=Cuttle Fish
				side=2
				x=28
				y=43
			[/unit]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair1
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			
			[unit]
				type=Water Serpent
				side=2
				x=28
				y=43
			[/unit]
			
		[/then]
		[/if]
		
		#Lair 2 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair2
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			
			[unit]
				type=Giant Spider0
				side=3
				x=7
				y=44
			[/unit]
			[unit]
				type=Giant Spider0
				side=3
				x=7
				y=44
			[/unit]
			[unit]
				type=Giant Spider0
				side=3
				x=7
				y=44
			[/unit]
			[unit]
				type=Giant Spider0
				side=3
				x=7
				y=44
			[/unit]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair2
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Goblin Impaler
				side=3
				x=7
				y=44
				[/unit]
				[unit]
				type=Goblin Spearman
				side=3
				x=7
				y=44
				[/unit]
				[unit]
				type=Goblin Spearman
				side=3
				x=7
				y=44
				[/unit]
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Goblin Rouser
				side=3
				x=7
				y=44
				[/unit]
				[unit]
				type=Goblin Spearman
				side=3
				x=7
				y=44
				[/unit]
				[unit]
				type=Goblin Spearman
				side=3
				x=7
				y=44
				[/unit]
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		#Lair 3 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair3
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Dark Sorcerer
				side=4
				x=7
				y=25
				[/unit]
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Dark Adept
				side=4
				x=7
				y=25
				[/unit]
				[unit]
				type=Dark Adept
				side=4
				x=7
				y=25
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair3
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Shadow
				side=4
				x=7
				y=25
				[/unit]
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Ghost
				side=4
				x=7
				y=25
				[/unit]
				[unit]
				type=Ghost
				side=4
				x=7
				y=25
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		#Lair 4 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair4
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Blood Bat
				side=5
				x=14
				y=5
				[/unit]
				[unit]
				type=Blood Bat
				side=5
				x=14
				y=5
				[/unit]
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Blood Bat
				side=5
				x=14
				y=5
				[/unit]
				[unit]
				type=Vampire Bat
				side=5
				x=14
				y=5
				[/unit]
				[unit]
				type=Vampire Bat
				side=5
				x=14
				y=5
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair4
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			
			[unit]
				type=Wolf
				side=5
				x=14
				y=5
			[/unit]
			[unit]
				type=Wolf
				side=5
				x=14
				y=5
			[/unit]
			
		[/then]
		[/if]
		
		#Lair 5 does not produce spawns and is labeled passive	
		
		#Lair 6 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair6
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			
			[unit]
				type=Gryphon
				side=7
				x=52
				y=4
			[/unit]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair6
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Giant Ooze
				side=7
				x=52
				y=4
				[/unit]
				[unit]
				type=Giant Ooze
				side=7
				x=52
				y=4
				[/unit]
				
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Giant Ooze
				side=7
				x=52
				y=4
				[/unit]
				[unit]
				type=Ooze
				side=7
				x=52
				y=4
				[/unit]
				[unit]
				type=Ooze
				side=7
				x=52
				y=4
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		#Lair 7 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair7
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Bone Shooter
				side=8
				x=52
				y=19
				[/unit]
				
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Skeleton
				side=8
				x=52
				y=19
				[/unit]
				[unit]
				type=Skeleton Archer
				side=8
				x=52
				y=19
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair7
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Necrophage
				side=8
				x=52
				y=19
				[/unit]
				
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Ghoul
				side=8
				x=52
				y=19
				[/unit]
				[unit]
				type=Ghoul
				side=8
				x=52
				y=19
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]
		
		#Lair 8 spawns
		
		[set_variable]
		name=monster_spawn
		random=0,1,2,3,4
		[/set_variable]
		[set_variable]
		name=monster_variety
		random=1,2
		[/set_variable]
		
		[if]
		[variable]
			name=lair8
			numerical_equals=1
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
	
			[unit]
				type=Giant Scorpion
				side=9
				x=52
				y=31
			[/unit]
			[unit]
				type=Giant Scorpion
				side=9
				x=52
				y=31
			[/unit]
			
		[/then]
		[/if]
		
		[if]
		[variable]
			name=lair8
			numerical_equals=2
		[/variable]
		[and]
		[variable]
			name=monster_spawn
			numerical_equals=0
		[/variable]
		[/and]
		[then]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=1
			[/variable]
			[then]
				[unit]
				type=Ogre
				side=9
				x=52
				y=31
				[/unit]
				
			[/then]
			[/if]
			[if]
			[variable]
			name=monster_variety
			numerical_equals=2
			[/variable]
			[then]
				[unit]
				type=Young Ogre
				side=9
				x=52
				y=31
				[/unit]
				[unit]
				type=Young Ogre
				side=9
				x=52
				y=31
				[/unit]
				
			[/then]
			[/if]
			
		[/then]
		[/if]

		
[/event]

#########################
#####ENDLEVEL EVENTS#####
#########################

[event]
	name=die
    first_time_only=no
    
    [filter]
    	[not]
        	side=1
        [/not]
    [/filter]
    
    
    [if]
		[variable]
			name=lairs_cleared
			numerical_equals=8
		[/variable]
		[then]
		
		#If all monster lairs cleared then check if the monster sides have any units left, if not, endlevel
		
    	[if]
        [have_unit]
        	side=2

            [not]
	        	x,y=$x1,$y1
            [/not]
		[/have_unit]
        [or]
        [have_unit]
        	side=3

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
        	side=4

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
	    	side=5

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
        	side=6

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
        	side=7

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
        	side=8

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]
        [or]
        [have_unit]
        	side=9

        	[not]
        		x,y=$x1,$y1
        	[/not]
        [/have_unit]
        [/or]

        [then]
        [/then]
                                [else]
                                    [message]
                                        speaker=Bryony
                                        message= _ "This island has been cleared! Way to go, Aurelia! Now our researchers will be able to work safely."
                                    [/message]
                                    
                                    [set_variable]
										name=kingdom_happiness
										add=5
									[/set_variable]
									[if]
										[variable] 
											name=kingdom_happiness 
											greater_than=100
										[/variable]
									[then]
									[set_variable]
										name=kingdom_happiness
										value=100
									[/set_variable]
									[/then]
									[/if]
        							[message]
										speaker=narrator
										image=wesnoth-icon.png
										message= _ "VICTORY BONUS!
Your subjects are grateful that you're actively trying to restore the magic barriers! Kingdom happiness increases by 5 to $kingdom_happiness!"
									[/message]
                                    
                                    [unstore_unit]
										variable=Kirielle_store
									[/unstore_unit]
				
    								{CLEAR_VARIABLE Kirielle_store}
    	 							{CLEAR_VARIABLE monster_infighting}
    	 							{CLEAR_VARIABLE lairs_cleared}
    	 							{CLEAR_VARIABLE lair1}
    	 							{CLEAR_VARIABLE lair2}
    	 							{CLEAR_VARIABLE lair3}
    	 							{CLEAR_VARIABLE lair4}
    	 							{CLEAR_VARIABLE lair5}
    	 							{CLEAR_VARIABLE lair6}
    	 							{CLEAR_VARIABLE lair7}
    	 							{CLEAR_VARIABLE lair8}
    			
        							[endlevel]
										result=victory
										#carryover_percentage=100
										{NEW_GOLD_CARRYOVER 40}
									[/endlevel]
									
                                [/else]
                            [/if]
                            
		[/then]
	[/if]
	
[/event]




[event]
name=time over
		[message]
        speaker=Bryony
        message= _ "We took too long! The monsoon season has come and all is lost!"
        [/message]
        [endlevel]
		result=defeat
		[/endlevel]
[/event]

# Load death speeches
{~add-ons/Elvish_Dynasty/utils/deathspeeches.cfg}

# Load unity magic
{~add-ons/Elvish_Dynasty/utils/aureliaunity.cfg}
{~add-ons/Elvish_Dynasty/utils/bryonyunity.cfg}

#Load promotions
{~add-ons/Elvish_Dynasty/utils/promotions.cfg}

#Load spoils of war from 14b
{~add-ons/Elvish_Dynasty/utils/spoils_of_war.cfg}



[/scenario]
