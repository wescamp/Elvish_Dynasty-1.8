#textdomain wesnoth-Elvish_Dynasty
[scenario]

id=17aED
next_scenario=EDTier2
name = _"Armageddon"
victory_when_enemies_defeated=no

map_data="{~add-ons/Elvish_Dynasty/maps/17aEDVolcano}"
turns=35

#Do NOT decrease turn limit on this map for higher difficulty levels...
#...or it will be impossible for all refugees to make it to safety

#Difficulty level affects enemy gold

	{DAWN}
    {DUSK}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
	
	{SCENARIO_MUSIC "legends_of_the_north.ogg"}
    {EXTRA_SCENARIO_MUSIC "heroes_rite.ogg"}
    

[side]
	side=1
	controller=human
	team_name=protagonist
	user_team_name= _"Florians"
	id=Aurelia
        name= _ "Aurelia"
        type=Aurelia Elvish Shaman
        canrecruit=yes
        unrenamable=yes
        recruit=
        gold=0
        colour=teal
		
	[village]
	x=4
	y=34
	[/village]
	[village]
	x=6
	y=30
	[/village]
	[village]
	x=12
	y=30
	[/village]
	[village]
	x=11
	y=33
	[/village]
	[village]
	x=13
	y=36
	[/village]
	[village]
	x=16
	y=31
	[/village]
	[village]
	x=19
	y=29
	[/village]
	[village]
	x=25
	y=29
	[/village]
	[village]
	x=24
	y=31
	[/village]
	[village]
	x=18
	y=20
	[/village]
	
[unit]
    	type=Elvish Peasant
		side=1
		id=Linly
		facing=sw
		name= _ "Linly the Elder"
		[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_AGED}
		[/modifications]
		x=25
		y=29
	[/unit]
	[unit]
    	type=Elvish Refugee
		side=1
		id=Linla
		facing=se
		role=refugee
		name= _ "Linla"
		[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_INTELLIGENT}
		[/modifications]
		x=15
		y=33
	[/unit] 
	
[/side] 

[side]
	side=2
	controller=ai
	team_name=children
	user_team_name= _"Children"
	id=Vanras
        name= _ "Patriarch Vanras"
        type=Armageddon Drake
        canrecruit=yes
        recruit=Direwolf Rider,Drake Warden,Drake Flameheart,Drake Enforcer,Drake Blademaster,Hurricane Drake,Inferno Drake
        
        #ifdef TOURIST
		gold=100
		#endif
	
		#ifdef EASY
		gold=175
		#endif
	
		#ifdef NORMAL
		gold=250
		#endif
	
		#ifdef HARD
		gold=325
		#endif

        facing=sw
        [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_STRONG}
		[/modifications]
	
	[village]
	x=36
	y=8
	[/village]
	[village]
	x=38
	y=11
	[/village]
	[village]
	x=38
	y=13
	[/village]
	[village]
	x=35
	y=15
	[/village]
	[village]
	x=33
	y=17
	[/village]
	[village]
	x=37
	y=17
	[/village]
	[village]
	x=34
	y=19
	[/village]
	[village]
	x=36
	y=22
	[/village]
	
	
[/side]

[side]
	side=3
	controller=ai
	team_name=yetis
	user_team_name= _"Yetis"
	id=Zulaat
        name= _ "Zulaat"
        type=Yeti
        canrecruit=yes
        recruit=Yeti
        #one yeti costs 80 gold
        gold=0
        
        #ifdef TOURIST
		income=10
		#endif
	
		#ifdef EASY
		income=15
		#endif
	
		#ifdef NORMAL
		income=20
		#endif
	
		#ifdef HARD
		income=25
		#endif

        [modifications]
		{TRAIT_INTELLIGENT}
		{TRAIT_STRONG}
		[/modifications]
	
[/side]


[event]
	name=prestart
	[objectives]
		side=1
		[objective]
			description= _ "Escort 10 refugees to safety"
			condition=win
		[/objective]
		[objective]
			description= _ "(Gold reward) Defeat Patriarch Vanras"
			condition=win
		[/objective]
		[objective]
        description= _ "Death of 5 refugees"
        condition=lose
    	[/objective]
		[objective]
        description= _ "Death of Aurelia"
        condition=lose
    	[/objective]
    	[objective]
        description= _ "Death of Bryony"
        condition=lose
    	[/objective]
    	[objective]
        description= _ "Turns run out"
        condition=lose
        [/objective]
    [/objectives]
    
    	 [recall]
            id=Bryony
            x=9
            y=35
         [/recall]
         
         [store_unit]
			variable=Kirielle_store
			kill=yes
			[filter]
			id=Kirielle
			[/filter]
		 [/store_unit]
		 
		[set_variable]
			name=refugees_saved
			value=0
		[/set_variable]
		[set_variable]
			name=refugees_killed
			value=0
		[/set_variable]
		[set_variable]
			name=vanras_attacked
			value=0
		[/set_variable]
		[set_variable]
			name=turn_count
			value=0
		[/set_variable]
		 
		 [label]
			x,y=24,4
			text= _ "Mount Zedlus"
		 [/label]
		 
		 [label]
			x,y=15,33
			text= _ "Refugee Camp"
		 [/label]
		 
		 [label]
			x,y=7,1
			text= _ "Safety"
		 [/label]
		 
		 [label]
			x,y=5,2
			text= _ "Refugees killed: $refugees_killed"
		 [/label]
		 
		 [label]
			x,y=9,2
			text= _ "Refugees saved: $refugees_saved of 10"
		 [/label]
		 
		 {PLACE_IMAGE scenery/tent-ruin-1.png 16 33}
		 {PLACE_IMAGE scenery/tent-ruin-1.png 14 33}
		 {PLACE_IMAGE scenery/tent-ruin-1.png 15 35}
		 {PLACE_IMAGE items/gohere.png 7 1}

[/event]

[event]
	name=start
	
	[message]
        speaker=Bryony
        message= _ "Aurelia, look!"
    [/message]
    
	[scroll_to]
    	x,y=24,4
    [/scroll_to]
    
    [delay]
    	time=500
    [/delay]
	[message]
        speaker=narrator
        message= _ "A thick cloud of black smoke billows from Mount Zedlus and the stench of sulfur fills the air. Total chaos and confusion reign in the elvish settlements downslope as panicked refugees struggle to flee before the oncoming lava."
    [/message]
	[message]
        speaker=Linla
        message= _ "Come on father, it's time to go!"
    [/message]
    [message]
        speaker=Linly
        message= _ "I've lived on this mountain for one thousand years and I'm not about to leave now!"
    [/message]
    [message]
        speaker=Linla
        message= _ "The lava is at your doorstep! Flee while you still can!"
    [/message]
    [message]
        speaker=Linly
        message= _ "I'm not going anywhere!"
    [/message]
    
    [scroll_to]
    	x,y=19,19
    [/scroll_to]

    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 19 19}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 20 19}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=torch.ogg
    [/sound]
    {MODIFY_TERRAIN Re 18 19}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=torch.ogg
    [/sound]
    {MODIFY_TERRAIN Re 19 20}
    [redraw]
    [/redraw]
    
    [scroll_to]
    	x,y=30,18
    [/scroll_to]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 30 18}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 31 18}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=torch.ogg
    [/sound]
    {MODIFY_TERRAIN Re 32 18}
    [redraw]
    [/redraw]
    
    [scroll_to]
    	x,y=25,29
    [/scroll_to]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 24 28}
    [redraw]
    [/redraw]
    
    #Lava surrounds the house then destroys it
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 26 29}
    [redraw]
    [/redraw]
    
    [message]
        speaker=Linly
        message= _ "ARGH!!!"
    [/message]
    [kill]
    id=Linly
    animate=yes
    [/kill]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=flame-big.ogg
    [/sound]
    {MODIFY_TERRAIN Qlf 25 29}
    [redraw]
    [/redraw]
    
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=torch.ogg
    [/sound]
    {MODIFY_TERRAIN Re 24 29}
    [redraw]
    [/redraw]
    
    [delay]
    	time=500
    [/delay]
    [sound]
    	name=torch.ogg
    [/sound]
    {MODIFY_TERRAIN Re 25 30}
    [redraw]
    [/redraw]
    
    
    [message]
        speaker=Linla
        message= _ "FATHER!!!"
    [/message]
	[message]
        speaker=Vanras
        message= _ "(Mocking laughter) Look at the little prey. Running and dying. Hiding and dying."
    [/message]
    [message]
        speaker=Bryony
        message= _ "You! You're responsible for this!"
    [/message]
    [message]
        speaker=Vanras
        message= _ "I am the Grand Patriarch of the Children of Invix. How fortunate for you that I was absent when you fought our master. If I'd been at that battle things would've turned out quite differently. But this time you'll not be so lucky!"
    [/message]
    [message]
        speaker=Bryony
        message= _ "We'll see about that!"
    [/message]
    
    [scroll_to]
    	x,y=15,33
    [/scroll_to]

    [delay]
    	time=500
    [/delay]
    
    [message]
		speaker=narrator
		message= _ "Refugees assemble at the refugee camp each turn."
	[/message]
    [message]
		speaker=narrator
		image=items/gohere.png
		message= _ "Escort 10 refugees to safety."
	[/message]
	{HIGHLIGHT_IMAGE 7 1 items/gohere.png ()}
	
	[unit]
    	type=Yeti
		side=3
		facing=se
		x=3
		y=8
	[/unit]
	
	[scroll_to]
        x=3
        y=8
    [/scroll_to]
  	[delay]
    	time=1500
    [/delay]
	
	[message]
		speaker=narrator
		message= _ "Beware! Yeti savages infest the western mountains. The volcanic eruption has enraged them and they will attack both you and the drakes relentlessly."
	[/message]
	
	[scroll_to]
        x=19
        y=19
    [/scroll_to]
  	[delay]
    	time=1500
    [/delay]
    
    [message]
		speaker=narrator
		message= _ "Also, as the lava advances it may destroy villages or constrain your movement. Units caught in the lava will die. Note that drakes, being creatures born of fire, are immune to lava."
	[/message]
	
	[message]
        speaker=Vanras
        message= _ "Death to the infidels!"
    [/message]
    
	[sound]
		name=magic-dark.ogg
	[/sound]
    [message]
    	speaker=narrator
        message= _ "Vanras Unity Magic: 
					Unity Magic Level 2 Activated!
					Vanras has given all his units +6 hit points!"
    [/message]
    
[/event]

[event]
	name=turn 2
	
	[message]
        speaker=Bryony
        message= _ "My goodness! It should be broad daylight, but there's so much smoke and soot in the air it's blocking out the sun!"
    [/message]
    [message]
        speaker=Aurelia
        message= _ "That may actually be good news for us. Drakes fight better during the day."
    [/message]
[/event]

##########################
#####LAVA FLOW EVENTS#####
##########################

#Every turn divisible by 4, for a total of 8

[event]
	name=turn 4
	
	{MODIFY_TERRAIN Qlf 18 19}
	{MODIFY_TERRAIN Qlf 19 20}
	{MODIFY_TERRAIN Qlf 24 29}
	{MODIFY_TERRAIN Qlf 25 30}
	{MODIFY_TERRAIN Qlf 32 18}
	
	{MODIFY_TERRAIN Re 17 20}
	{MODIFY_TERRAIN Re 23 30}
	{MODIFY_TERRAIN Re 24 30}
	{MODIFY_TERRAIN Re 33 19}
	{MODIFY_TERRAIN Ww 29 30}
	
	[kill]
    	x=18,19,24,25,32
        y=19,20,29,30,18
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 8
	
	{MODIFY_TERRAIN Qlf 17 20}
	{MODIFY_TERRAIN Qlf 18 20}
	{MODIFY_TERRAIN Qlf 23 30}
	{MODIFY_TERRAIN Qlf 24 30}
	{MODIFY_TERRAIN Qlf 33 19}
	
	{MODIFY_TERRAIN Re 16 19}
	{MODIFY_TERRAIN Re 16 20}
	{MODIFY_TERRAIN Re 17 21}
	{MODIFY_TERRAIN Re 18 21}
	{MODIFY_TERRAIN Re 22 29}
	{MODIFY_TERRAIN Re 22 30}
	{MODIFY_TERRAIN Re 23 31}
	{MODIFY_TERRAIN Re 33 20}
	{MODIFY_TERRAIN Ww^Bw/ 29 31}
	
	
	[kill]
    	x=17,18,23,24,33
        y=20,20,30,30,19
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 12
	
	{MODIFY_TERRAIN Qlf 16 20}
	{MODIFY_TERRAIN Qlf 17 21}
	{MODIFY_TERRAIN Qlf 18 21}
	{MODIFY_TERRAIN Qlf 22 29}
	{MODIFY_TERRAIN Qlf 22 30}
	{MODIFY_TERRAIN Qlf 23 31}
	{MODIFY_TERRAIN Qlf 24 31}
	{MODIFY_TERRAIN Qlf 33 20}
	{MODIFY_TERRAIN Qlf 34 19}
	
	
	{MODIFY_TERRAIN Re 15 20}
	{MODIFY_TERRAIN Re 16 21}
	{MODIFY_TERRAIN Re 17 22}
	{MODIFY_TERRAIN Re 18 22}
	{MODIFY_TERRAIN Re 19 22}
	{MODIFY_TERRAIN Re 21 30}
	{MODIFY_TERRAIN Re 21 31}
	{MODIFY_TERRAIN Re 34 20}
	{MODIFY_TERRAIN Ww 29 32}
	{MODIFY_TERRAIN Mm 33 21}
	{MODIFY_TERRAIN Mm 35 19}
	{MODIFY_TERRAIN Mm 35 20}
	
	#Lava hits the chasm
	{MODIFY_TERRAIN Ql 1 14}
	{MODIFY_TERRAIN Ql 1 22}
	{MODIFY_TERRAIN Ql 1 26}
	{MODIFY_TERRAIN Ql 2 13}
	{MODIFY_TERRAIN Ql 2 21}
	{MODIFY_TERRAIN Ql 2 25}
	{MODIFY_TERRAIN Ql 2 26}
	{MODIFY_TERRAIN Ql 3 13}
	{MODIFY_TERRAIN Ql 3 21}
	{MODIFY_TERRAIN Ql 3 26}
	{MODIFY_TERRAIN Ql 4 17}
	{MODIFY_TERRAIN Ql 4 20}
	{MODIFY_TERRAIN Ql 4 26}
	{MODIFY_TERRAIN Ql 5 14}
	{MODIFY_TERRAIN Ql 5 17}
	{MODIFY_TERRAIN Ql 5 18}
	{MODIFY_TERRAIN Ql 5 21}
	{MODIFY_TERRAIN Ql 5 27}
	{MODIFY_TERRAIN Ql 6 14}
	{MODIFY_TERRAIN Ql 6 16}
	{MODIFY_TERRAIN Ql 6 17}
	{MODIFY_TERRAIN Ql 6 18}
	{MODIFY_TERRAIN Ql 6 20}
	{MODIFY_TERRAIN Ql 6 26}
	{MODIFY_TERRAIN Ql 6 27}
	{MODIFY_TERRAIN Ql 7 15}
	{MODIFY_TERRAIN Ql 7 16}
	{MODIFY_TERRAIN Ql 7 17}
	{MODIFY_TERRAIN Ql 7 18}
	{MODIFY_TERRAIN Ql 7 23}
	{MODIFY_TERRAIN Ql 7 24}
	{MODIFY_TERRAIN Ql 7 26}
	{MODIFY_TERRAIN Ql 7 28}
	{MODIFY_TERRAIN Ql 7 29}
	{MODIFY_TERRAIN Ql 8 17}
	{MODIFY_TERRAIN Ql 8 18}
	{MODIFY_TERRAIN Ql 8 19}
	{MODIFY_TERRAIN Ql 8 22}
	{MODIFY_TERRAIN Ql 8 23}
	{MODIFY_TERRAIN Ql 8 24}
	{MODIFY_TERRAIN Ql 8 25}
	{MODIFY_TERRAIN Ql 8 28}
	{MODIFY_TERRAIN Ql 9 19}
	{MODIFY_TERRAIN Ql 9 23}
	{MODIFY_TERRAIN Ql 9 24}
	{MODIFY_TERRAIN Ql 9 25}
	{MODIFY_TERRAIN Ql 9 26}
	{MODIFY_TERRAIN Ql 9 27}
	{MODIFY_TERRAIN Ql 10 19}
	{MODIFY_TERRAIN Ql 10 21}
	{MODIFY_TERRAIN Ql 10 24}
	{MODIFY_TERRAIN Ql 10 25}
	{MODIFY_TERRAIN Ql 10 26}
	{MODIFY_TERRAIN Ql 10 27}
	{MODIFY_TERRAIN Ql 11 20}
	{MODIFY_TERRAIN Ql 11 21}
	{MODIFY_TERRAIN Ql 11 22}
	{MODIFY_TERRAIN Ql 11 24}
	{MODIFY_TERRAIN Ql 11 25}
	{MODIFY_TERRAIN Ql 11 26}
	{MODIFY_TERRAIN Ql 11 27}
	{MODIFY_TERRAIN Ql 12 20}
	{MODIFY_TERRAIN Ql 12 21}
	{MODIFY_TERRAIN Ql 12 22}
	{MODIFY_TERRAIN Ql 12 23}
	{MODIFY_TERRAIN Ql 13 21}
	{MODIFY_TERRAIN Ql 13 22}
	{MODIFY_TERRAIN Ql 13 23}
	{MODIFY_TERRAIN Ql 14 21}
	{MODIFY_TERRAIN Ql 14 22}
	
	{MODIFY_TERRAIN Ql^Bs/ 4 13}
	{MODIFY_TERRAIN Ql^Bs\ 7 20}
	{MODIFY_TERRAIN Ql^Bs\ 7 26}
	{MODIFY_TERRAIN Ql^Bs\ 9 28}
	
	
	[kill]
    	x=16,17,18,22   ,23,24,33,34
        y=20,21,21,29-30,31,31,20,19
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
    
    [redraw]
    [/redraw]
    
    [scroll_to]
    	x,y=16,21
    [/scroll_to]
    
    [delay]
    	time=1500
    [/delay]
    
    [message]
        speaker=Bryony
        message= _ "The lava is filling up the chasm! The route to safety is getting more dangerous every minute. Let's hurry, Aurelia!"
    [/message]
[/event]

[event]
	name=turn 16
	
	{MODIFY_TERRAIN Qlf 16 21}
	{MODIFY_TERRAIN Qlf 17 22}
	{MODIFY_TERRAIN Qlf 18 22}
	{MODIFY_TERRAIN Qlf 19 22}
	{MODIFY_TERRAIN Qlf 21 30}
	{MODIFY_TERRAIN Qlf 21 31}
	{MODIFY_TERRAIN Qlf 34 20}
	
	{MODIFY_TERRAIN Re 20 29}
	{MODIFY_TERRAIN Re 20 30}
	{MODIFY_TERRAIN Re 35 21}
	{MODIFY_TERRAIN Ww 28 32}
	{MODIFY_TERRAIN Ww 30 31}
	{MODIFY_TERRAIN Mm 17 23}
	{MODIFY_TERRAIN Mm 18 23}
	{MODIFY_TERRAIN Mm 19 23}
	{MODIFY_TERRAIN Mm 20 22}
	{MODIFY_TERRAIN Mm 20 31}
	{MODIFY_TERRAIN Mm 34 21}
	{MODIFY_TERRAIN Hh 16 22}
	
	[kill]
    	x=16,17,18,19,21   ,34
        y=21,22,22,22,30-31,20
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 20
	
	{MODIFY_TERRAIN Qlf 20 29}
	{MODIFY_TERRAIN Qlf 20 30}
	{MODIFY_TERRAIN Qlf 35 21}
	
	{MODIFY_TERRAIN Re 19 30}
	{MODIFY_TERRAIN Re 36 20}
	{MODIFY_TERRAIN Re 36 21}
	{MODIFY_TERRAIN Re 35 22}
	{MODIFY_TERRAIN Ww 28 33}
	{MODIFY_TERRAIN Ww 30 32}
	{MODIFY_TERRAIN Mm 19 31}
	{MODIFY_TERRAIN Mm 20 28}
	
	[kill]
    	x=20,20,35
        y=29,30,21
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 24
	
	{MODIFY_TERRAIN Qlf 19 29}
	{MODIFY_TERRAIN Qlf 19 30}
	{MODIFY_TERRAIN Qlf 35 22}
	{MODIFY_TERRAIN Qlf 36 21}
	
	
	{MODIFY_TERRAIN Re 18 29}
	{MODIFY_TERRAIN Re 18 30}
	{MODIFY_TERRAIN Re 34 22}
	{MODIFY_TERRAIN Ww 27 34}
	{MODIFY_TERRAIN Ww 31 31}
	{MODIFY_TERRAIN Mm 19 28}
	{MODIFY_TERRAIN Mm 37 21}
	{MODIFY_TERRAIN Mm 37 22}
	{MODIFY_TERRAIN Hh 18 28}
	{MODIFY_TERRAIN Hh 35 23}
	
	[kill]
    	x=19   ,35,36
        y=29-30,22,21
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 28
	
	{MODIFY_TERRAIN Qlf 18 29}
	{MODIFY_TERRAIN Qlf 18 30}
	{MODIFY_TERRAIN Qlf 34 22}
	{MODIFY_TERRAIN Qlf 36 22}
	
	{MODIFY_TERRAIN Re 33 23}
	{MODIFY_TERRAIN Ww 27 35}
	{MODIFY_TERRAIN Ww 28 34}
	{MODIFY_TERRAIN Ww 31 32}
	{MODIFY_TERRAIN Mm 33 22}
	{MODIFY_TERRAIN Mm 36 23}
	{MODIFY_TERRAIN Mm 37 23}
	{MODIFY_TERRAIN Hh 34 23}
	{MODIFY_TERRAIN Hh 17 29}
	{MODIFY_TERRAIN Hh 17 30}
	{MODIFY_TERRAIN Hh 17 31}
	{MODIFY_TERRAIN Hh 18 31}
	
	[kill]
    	x=18   ,34,36
        y=29-30,22,22
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

[event]
	name=turn 32
	
	{MODIFY_TERRAIN Qlf 33 23}
	
	{MODIFY_TERRAIN Re 33 24}
	{MODIFY_TERRAIN Ww 27 36}
	{MODIFY_TERRAIN Ww 29 34}
	{MODIFY_TERRAIN Mm 32 22}
	{MODIFY_TERRAIN Mm 32 23}
	
	[kill]
    	x=33
        y=23
        [not]
        race=drake
        [/not]
        fire_event=yes
        animate=yes
    [/kill]
[/event]

########################
#####REFUGEE EVENTS#####
########################

#Tried to make refugees AI controlled but pathfinding AI keeps getting stuck... 

#Also would've liked to do this with a single side 1 turn event, rather than 15 seperate ones
#But problems with implementing unity magic mean we have to do it this way

#Refugee spawns

[event]
	name=turn 2
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee2
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee2
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee2
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]

[event]
	name=turn 3
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee3
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee3
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee3
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 4
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee4
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee4
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee4
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 5
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee5
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee5
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee5
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 6
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee6
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee6
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee6
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 7
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee7
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee7
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee7
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 8
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee8
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee8
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee8
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 9
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee9
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee9
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee9
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 10
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee10
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee10
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee10
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 11
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee11
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee11
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee11
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 12
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee12
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee12
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee12
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 13
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee13
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee13
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee13
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]


[event]
	name=turn 14
	
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee14
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee14
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee14
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]

[event]
	name=turn 15
	
	[message]
        speaker=Bryony
        message= _ "All refugees have assembled. Now let's make sure they get to safety!"
    [/message]
    
	[set_variable]
		name=refugee_variety
		random=0,1
	[/set_variable]
	
	[if]
		[variable]
			name=refugee_variety
			numerical_equals=0
		[/variable]
		[then]
		
		[unit]
    		type=Elvish Peasant
			side=1
			id=Refugee15
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=aurelia_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=aurelia_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=aurelia_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=attack
					range=melee
					increase_damage=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/then]
		[else]
		
		[unit]
    		type=Elvish Refugee
			side=1
			id=Refugee15
			role=refugee
			name= _ "Refugee"
			x=15
			y=33
		[/unit]
		
			[if]
				[variable] 
				name=bryony_happiness 
				greater_than=95
				[/variable]
				[then]
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=2
        		[/effect]
    			[/object]

				[/then]
			[/if]
			[if]
				[variable] 
					name=bryony_happiness 
					greater_than=50
				[/variable]
				[and]
				[variable] 
					name=bryony_happiness 
					less_than_equal_to=95
				[/variable]
				[/and]
				[then]
				
				
    			[object]
        			silent=yes
       
        		[filter]
       				id=Refugee15
    			[/filter]
       
        		[effect]
            		apply_to=movement
            		increase=1
        		[/effect]
    			[/object]

				[/then]
			[/if]
			
		[/else]
	[/if]
		
[/event]

#Maybe we can get this working some day...

#[event]
#	name=side 1 turn
#	first_time_only=no
	
#	[set_variable]
#		name=refugee_variety
#		random=0,1
#	[/set_variable]
	
#	[if]
#		[variable]
#			name=turn_count
#			less_than=15
#		[/variable]
#		[then]
		
#		[if]
#		[variable]
#			name=refugee_variety
#			numerical_equals=0
#		[/variable]
#		[then]
			
#		[unit]
#   		type=Elvish Peasant
#			side=1
#			role=refugee
#			name= _ "Refugee"
#			x=15
#			y=33
#		[/unit]
#		[set_variable]
#			name=turn_count
#			add=1
#		[/set_variable]
		
#			[if]
#				[variable] 
#				name=aurelia_happiness 
#				greater_than=95
#				[/variable]
#				[then]
				
#				[store_unit]
#   			[filter]
#        			role=refugee
#    			[/filter]
   
#    			kill=no
#    			variable=units
#				[/store_unit]
				
#				{FOREACH units i}
				
#    			[object]
#        			silent=yes
       
#        		[filter]
#      				id=$units[$i].id
#      				[not]
#          				find_in=refugees_already_strength_buffed
#      				[/not]
#    			[/filter]
       
#        		[effect]
#            		apply_to=attack
#					range=melee
#					increase_damage=2
#        		[/effect]
#    			[/object]
#    			{NEXT i}
    			
#    			[store_unit]
#        			[filter]
#            			id=$units[$i].id
#        			[/filter]
       
#        			variable=refugees_already_strength_buffed
#        			mode=append
#        			kill=no
#    			[/store_unit]

#				[/then]
#			[/if]
		
#		[/then]
#		[else]
		
#		[unit]
#    		type=Elvish Refugee
#			side=1
#			role=refugee
#			name= _ "Refugee"
#			x=15
#			y=33
#		[/unit]
#		[set_variable]
#			name=turn_count
#			add=1
#		[/set_variable]
		
#		[/else]
#		[/if]
		
#		[/then]
#	[/if]
	
#[/event]

#Refugee reaches safety
[event]
	name=moveto
	first_time_only=no
		[filter]
			role=refugee
			x=7
			y=1
		[/filter]
		
		[set_variable]
			name=refugees_saved
			add=1
		[/set_variable]
		
		[set_variable]
		name=random_thanks
		random=1,2,3,4,5
		[/set_variable]
		
		[if]
		[variable]
			name=random_thanks
			numerical_equals=1
		[/variable]
		[then]
		[message]
			speaker=unit
			message= _ "I can't believe I made it! ($refugees_saved of 10 refugees saved!)"
		[/message]
		[/then]
		[/if]
		
		[if]
		[variable]
			name=random_thanks
			numerical_equals=2
		[/variable]
		[then]
		[message]
			speaker=unit
			message= _ "Thanks for the escort! ($refugees_saved of 10 refugees saved!)"
		[/message]
		[/then]
		[/if]
		
		[if]
		[variable]
			name=random_thanks
			numerical_equals=3
		[/variable]
		[then]
		[message]
			speaker=unit
			message= _ "Safety at last! ($refugees_saved of 10 refugees saved!)"
		[/message]
		[/then]
		[/if]
		
		[if]
		[variable]
			name=random_thanks
			numerical_equals=4
		[/variable]
		[then]
		[message]
			speaker=unit
			message= _ "Give those drakes hell, Aurelia! ($refugees_saved of 10 refugees saved!)"
		[/message]
		[/then]
		[/if]
		
		[if]
		[variable]
			name=random_thanks
			numerical_equals=5
		[/variable]
		[then]
		[message]
			speaker=unit
			message= _ "May the Goddess bless you, Aurelia! ($refugees_saved of 10 refugees saved!)"
		[/message]
		[/then]
		[/if]
		
		[kill]
		x=7
		y=1
		fire_event=no
		[/kill]
		
		[label]
			x,y=9,2
			text= _ "Refugees saved: $refugees_saved of 10"
		[/label]
		 
		[if]
		[variable]
			name=refugees_saved
			numerical_equals=10
		[/variable]
		[then]
		[message]
        	speaker=Bryony
        	message= _ "We did it, Aurelia! Most of the refugees have made it to safety and the drakes are breaking off their attack! You're wonderful!"
    	[/message]
    	
    			[set_variable]
					name=kingdom_happiness
					add=5
				[/set_variable]
				[if]
					[variable] 
					name=kingdom_happiness 
					greater_than=100
					[/variable]
					[then]
					[set_variable]
					name=kingdom_happiness
					value=100
					[/set_variable]
					[/then]
				[/if]
        		[message]
					speaker=narrator
					image=wesnoth-icon.png
					message= _ "VICTORY BONUS!
The Florian people are happy with your prompt and effective reaction to this crisis! Kingdom happiness increases by 5 to $kingdom_happiness!"
				[/message]
				
				[kill]
					role=refugee
				[/kill]
    	
    	[unstore_unit]
		variable=Kirielle_store
		find_vacant=yes
		[/unstore_unit]
				
    	{CLEAR_VARIABLE Kirielle_store}
    	{CLEAR_VARIABLE refugees_saved}
    	{CLEAR_VARIABLE refugees_killed}
    	{CLEAR_VARIABLE random_thanks}
    	{CLEAR_VARIABLE vanras_attacked}
    
    	[endlevel]
			result=victory
			#carryover_percentage=100
			{NEW_GOLD_CARRYOVER 40}
		[/endlevel]
	
		[/then]
		[/if]
		
[/event]

#Refugee killed
[event]
	name=die
	first_time_only=no
	[filter]
		role=refugee
	[/filter]
	
	[set_variable]
			name=refugees_killed
			add=1
	[/set_variable]
		
	[message]
    	id=Bryony
        message= _ "Our people are dying Aurelia! Protect them!"
    [/message]
    [message]
    	id=Aurelia
        message= _ "I'm trying! ($refugees_killed refugees killed so far! Five refugee deaths will result in defeat!)"
    [/message]
    
    [label]
		x,y=5,2
		text= _ "Refugees killed: $refugees_killed"
	[/label]
    
    [if]
		[variable]
			name=refugees_killed
			numerical_equals=5
		[/variable]
		[then]
		
		[message]
    		id=Bryony
        	message= _ "The refugees have been massacred! We lost!"
    	[/message]
    	
    	[endlevel]
		result=defeat
		[/endlevel]
    	
		[/then]
	[/if]
	
[/event]

#######################
#####DRAKE SPAWNS######
#######################

#The drake spawns were replaced by yetis to add variety to the opposition and...
#...due to the difficulty of applying unity magic to the spawned enemies.

#There's a flat 50% chance of a random enemy generation in the west mountains every turn
#[event]
#        name=new turn
#        first_time_only=no
        
#        [set_variable]
#		name=surprise_number
#		random=1,2,3,4,5,6,7,8,9,10
#		[/set_variable]
		
#		[if]
#			[variable]
#			name=surprise_number
#			numerical_equals=6
#			[/variable]
#			[then]
#				[unit]
#					type=Wolf Rider
#					side=2
#					x=1
#					y=3
#				[/unit]			
			    
#			[/then]
#		[/if]
#		[if]
#			[variable]
#			name=surprise_number
#			numerical_equals=7
#			[/variable]
#			[then]
#				[unit]
#					type=Drake Glider
#					side=2
#					x=1
#					y=5
#				[/unit]
			    
#			[/then]
#		[/if]
#		[if]
#			[variable]
#			name=surprise_number
#			numerical_equals=8
#			[/variable]
#			[then]
#				[unit]
#					type=Goblin Knight
#					side=2
#					x=1
#					y=7
#				[/unit]
			    
#			[/then]
#		[/if]
#		[if]
#			[variable]
#			name=surprise_number
#			numerical_equals=9
#			[/variable]
#			[then]
#				[unit]
#					type=Drake Burner
#					side=2
#					x=1
#					y=9
#				[/unit]
			    
#			[/then]
#		[/if]
		
#		[if]
#			[variable]
#			name=surprise_number
#			numerical_equals=10
#			[/variable]
#			[then]
#				[unit]
#					type=Sky Drake
#					side=2
#					x=1
#					y=11
#				[/unit]
			    
#			[/then]
#		[/if]
#[/event]
		

#######################
#####VANRAS COMBAT#####
#######################

[event]
        name=attack
        first_time_only=no
        [filter]
            side=1
        [/filter]
        [filter_second]
            id=Vanras
        [/filter_second]
        
        [if]
		[variable]
			name=vanras_attacked
			numerical_equals=0
		[/variable]
		[then]
		
		[set_variable]
			name=vanras_attacked
			value=1
		[/set_variable]
		[message]
            id=Vanras
            message= _ "By fire and sword we will purge this land. If I were you, I'd start praying now."
        [/message]
        
		[/then]
		[/if]
        
[/event]

[event]
        name=attack
        first_time_only=no
        [filter]
            id=Vanras
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        
        [if]
		[variable]
			name=vanras_attacked
			numerical_equals=0
		[/variable]
		[then]
		
		[set_variable]
			name=vanras_attacked
			value=1
		[/set_variable]
		[message]
            id=Vanras
            message= _ "By fire and sword we will purge this land. If I were you, I'd start praying now."
        [/message]
        
		[/then]
		[/if]
        
[/event]

[event]
        name=last breath
        [filter]
            id=Vanras
        [/filter]
        
        [message]
        	speaker=Vanras
        	message= _ "Well fought. But my soldiers will fight on! Your people will not escape the fire!"
    	[/message]
    	
    	[sound]
			name=gold.ogg
		[/sound]
		[gold]
			side=1
			amount=30
		[/gold]
		
		[message]
            speaker=Vanras
            message= _ "(The drake's unity magic has dissipated.)"
        [/message]
        
        [store_unit]
    		[filter]
        side=2
        #Need to specify not Vanras here, otherwise he won't die if the AI kills him
        [not]
        id=Vanras
        [/not]
    		[/filter]
   
   	    kill=no
    	variable=units
		[/store_unit]
	
		{FOREACH units i}
    	[object]
        silent=yes
       
        [filter]
            id=$units[$i].id
        [/filter]
       
        [effect]
            	apply_to=hitpoints
            	increase_total=-6
        [/effect]
    	[/object]
		{NEXT i}

		{CLEAR_VARIABLE units}
		
		[message]
        	speaker=Bryony
        	message= _ "We found 30 gold pieces in his keep!"
    	[/message]
    
    
[/event]
		

#####################
#####UNITY MAGIC#####
#####################

#Vanras's unity magic (reinstated in v 0.9.7)
[event]
	name=recruit
	first_time_only=no
	
    [object]
        silent=yes
       
        [filter]
            id=$unit.id
            side=2
        [/filter]
       
        [effect]
            	apply_to=hitpoints
            	increase_total=6
            	increase=6
        [/effect]
    [/object]
    
[/event]




[event]
name=time over
        [message]
        speaker=Bryony
        message= _ "Oh no, we took too long! The Children have brought in reinforcements and all is lost!"
        [/message]
        [endlevel]
		result=defeat
		[/endlevel]
[/event]

[event]
        name=last breath
        [filter]
            id=Zulaat
        [/filter]
        
        [message]
        	speaker=Zulaat
        	message= _ "WAAAGH!"
    	[/message]
		
		[message]
        	speaker=Bryony
        	message= _ "That should make the road to safety a little bit easier. Keep up the good work, Aurelia!"
    	[/message]
    
    
[/event]


# Load death speeches
{~add-ons/Elvish_Dynasty/utils/deathspeeches.cfg}

# Load unity magic
{~add-ons/Elvish_Dynasty/utils/aureliaunity.cfg}
{~add-ons/Elvish_Dynasty/utils/bryonyunity.cfg}

#Load promotions
{~add-ons/Elvish_Dynasty/utils/promotions.cfg}

#Load spoils of war from 14b
{~add-ons/Elvish_Dynasty/utils/spoils_of_war.cfg}


[/scenario]
